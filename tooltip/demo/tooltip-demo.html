<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="x-tag-components.css"/>
    <link rel="stylesheet" type="text/css" href="../src/tooltip.css"/>
    
    <script type="text/javascript" src="x-tag-components.js"></script>
    <script type="text/javascript" src="../src/tooltip.js"></script>
    <style>
        body, html{
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }
        
        #container{
            border: 1px solid grey;
            margin: 0 auto;
            width: 320px;
            height: 480px;
            position: relative;
        }
        
        #prev-sib{
            position: relative;
            margin: 1em;
            border: 1px solid grey;
            overflow: visible;
        }
        
        #next-sib{
            margin-top: 10em;
            background-color: cyan; 
            position: relative;
        }
        
        .fancy-selector{
            position: relative;
            display: inline-block;
            background-color: lightsteelblue;
            font-size: 1.2em;
            margin:.5em;
        }
        
        /* arrow is always in relation to content, so modify borders here */
        #demoTip{
            border-radius: 4px;
            border: 2px solid black;
            
            background: orange url('cream_pixels.png') center repeat repeat;
        }
        
        #demoTip > .tooltip-content{
            padding: .5em;
            font-family: Courier;
        }
        
        #demoTip > .tooltip-arrow{
            /*background-color: orange;*/
        }
        
        /** users can apply custom styles using this attribute for anything
         ** with a tooltip attached **/
        [x-tooltip-targeted]{
            box-shadow: 1px 1px 10px goldenrod;
        }
        
        [x-tooltip-targeted=click]:hover{
            cursor: pointer;
            opacity: 0.7;
        }
        
        /** example usage: attaching a tooltip indicator to elements **/
        [x-tooltip-targeted]:after{
            content: "?";
            position: absolute;
            right: -7px;
            bottom: -7px;
            background-color: blue;
            color: white;
            font-size: 1.1em;
            border: 1px solid white;
            box-shadow: 1px 1px 4px grey;
            border-radius: 100%;
            width: 20px;
            height: 20px;
            text-align: center;
        }
        
        #controls{
            text-align: center;
        }
    </style>
</head>
<body>
<h1>X-ToolTip demo</h1>
<span class="fancy-selector">Out of scope ".fancy-selector" box</span>
<div id="container">
    parent node
    <button id="prev-sib">
        <p style="background-color: tomato;">prev sibling
            <img src="http://placekitten.com/100/50"/>
        </p>
    </button>
    <x-tooltip id="demoTip" trigger-selector="_nextSibling">
        Hi! I'm a tooltip! <img src="http://placekitten.com/30"/>
        <br/><a href="http://google.com">Lorem ipsum</a><span class="fancy-selector">buttes</span> 
    </x-tooltip>
    <div id="next-sib">
        <h1>Next sibling</h1>
    </div>
    <div style="position: relative; background-color: lavender">    
        <span class="fancy-selector">#</span>
        <span class="fancy-selector">".fancy-selector" box</span>
    </div>
</div>


<div id="controls">
    <button onClick="changeOrientation()">Change orientation</button>
    <button onClick="toggleVisible(event)">Toggle visible (debug, not intended for API)</button>
    <button onClick="toggleSelector()">Toggle selector</button>
    <button onClick="toggleTriggerStyle()">Toggle trigger style</button>
    <button onClick="changeContents()">Change tooltip contents</button>
    <br/>
    <span>Current selector = <span id="curr-selector-status"></span></span>
    <br/>
    <span>Current orientation = <span id="curr-orient-status"></span></span>
    <br/>
    <span>Current trigger style = <span id="curr-trigger-style-status"></span></span>
</div>
<script>
var demoTip;
document.addEventListener('DOMComponentsLoaded', function(){
    demoTip = document.getElementById("demoTip");
    updateSelectorBox();
    updateOrientationBox();
    updateTriggerStyleBox();
});

function changeOrientation(){
    var orients = ["auto", "above", "onright", "below", "onleft"];
    var currOrient = demoTip.orientation;
    
    var currIndex = orients.indexOf(currOrient);
    
    demoTip.setAttribute("orientation", orients[(currIndex+1) % orients.length]);
    updateOrientationBox();
}

function toggleVisible(e){
    demoTip.visible = !demoTip.visible;
    e.stopPropagation();
}

function toggleSelector(){
    var selectors = ["_previousSibling", "_nextSibling", ".fancy-selector"];
    var currSelector = demoTip["trigger-selector"];
    
    var currIndex = selectors.indexOf(currSelector);
    
    demoTip["trigger-selector"] = selectors[(currIndex+1) % selectors.length];
    updateSelectorBox();
}

function toggleTriggerStyle(){
    var styles = ["click", "hover"];
    var currStyle = demoTip["trigger-style"];
    
    var currIndex = styles.indexOf(currStyle);
    
    demoTip["trigger-style"] = styles[(currIndex+1) % styles.length];
    
    updateTriggerStyleBox();
}

function updateSelectorBox(){
    var statusBox = document.getElementById("curr-selector-status");
    
    statusBox.textContent = demoTip["trigger-selector"];
}

function updateOrientationBox(){
    var statusBox = document.getElementById("curr-orient-status");
    
    statusBox.textContent = demoTip.orientation;
}

function updateTriggerStyleBox(){
    var triggerStyleBox = document.getElementById("curr-trigger-style-status");
    
    triggerStyleBox.textContent = demoTip["trigger-style"];
}

function randomKittenUrl(){
    var catNumber = Math.floor(Math.random() * 15 + 1);
    
    return "http://placekitten.com/50/?image="+catNumber;
}

function changeContents(){
    var contentEl = demoTip.content;
    
    var htmlStrs = [
        "Hi! I'm a tooltip! <img src=\"http://placekitten.com/30\"/><br/><a href=\"http://google.com\">Lorem ipsum</a><span class=\"fancy-selector\">buttes</span>",
        "Nothing here!",
        "<img src='"+randomKittenUrl()+"'/><img src='"+randomKittenUrl()+"'/><img src='"+randomKittenUrl()+"'/>",
        "<img src='http://i.imgur.com/pQFn2wj.gif'/>",
        "A<br/>B<br/>C",
        ""
    ];
    
    var randomHtml = htmlStrs[Math.floor(Math.random() * htmlStrs.length)];
    
    contentEl.innerHTML = randomHtml;
}
</script>
</body>
</html>